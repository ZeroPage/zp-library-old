{% extends "zp_library/base.html" %}
{% block content %}

    {% if book %}
        <div layout="row" layout-sm="column">
            {% if book.thumbnail %}
            <div flex-order="1" layout-align="center center" layout="row" layout-padding>
                <img class="width-medium" src="{{ book.thumbnail }}" onerror="if (this.src != '{{ no_img_url }}') this.src = '{{ no_img_url }}';">
            </div>
            {% endif %}
            <div flex flex-order="2" layout="column">
                <div flex></div>
                <div>
                    <h2 class="md-display-2">{{ book.title|escape }}</h2>
                    <p class="md-display-1">{{ book.author|escape }}</p>
                </div>
            </div>
        </div>
        <md-divider></md-divider>
        {% if basic_info.items or extra_info.items %}
        <div>
            <md-chips class="md-primary">
                {% for key, value in basic_info.items %}
                    <md-chip><strong>{{ key }}:</strong> {{ value }}</md-chip>
                {% endfor %}

                {% for key, value in extra_info.items %}
                    <md-chip><strong>{{ key }}:</strong> {{ value }}</md-chip>
                {% endfor %}
            </md-chips>
        </div>
        {% endif %}

        {% if book.description %}
        <div>
            <h3>설명</h3>
            <md-content class="md-whiteframe-z1" layout-padding>
                <p>{{ book.description|escape }}</p>
            </md-content>
        </div>
        {% endif %}

        <div>
            <h3>대여 현황</h3>
            <md-content class="md-whiteframe-z1" layout-padding>
                {% if borrows %}
                <md-list>
                    {% for borrow_record in borrows %}
                    <md-list-item class="md-2-line">
                        <div class="md-list-item-text">
                            <h3>{{ borrow_record.name }}</h3>
                            <p>{{ borrow_record.borrowDate }} ~ {{ borrow_record.returnDate }}</p>
                        </div>
                    </md-list-item>
                    {% endfor %}
                </md-list>
                {% else %}
                <p>대여자가 없습니다.</p>
                {% endif %}
            </md-content>
        </div>

        <div layout="row" layout-padding>
            <md-button class="md-primary" ng-href="{% url book_borrow %}?isbn={{ isbn }}">대여/반납</md-button>
            <md-button class="md-primary" ng-href="{% url book_edit %}?isbn={{ isbn }}">수정</md-button>
            <md-button class="md-warn" ng-href="{% url book_delete %}?isbn={{ isbn }}">삭제</md-button>
        </div>
    {% else %}
        <h2>NO RESULT</h2>
        <p>isbn:{{ isbn }} not found.</p>
        <a href="{% url book_add %}?isbn={{ isbn }}">add it? (admin only)</a>
    {% endif %}
{% endblock %}
